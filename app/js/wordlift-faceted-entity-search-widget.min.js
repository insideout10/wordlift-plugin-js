(function(){var a,b,c,d=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=jQuery,angular.module("wordlift.facetedsearch.widget",[]).provider("configuration",function(){var a,b;return b=void 0,a={setConfiguration:function(a){return b=a},$get:function(){return b}}}).controller("FacetedSearchWidgetController",["DataRetrieverService","configuration","$scope","$log",function(a,b,c,e){return c.posts=[],c.facets=[],c.conditions=[],c.isInConditions=function(a){var b;return b=a.id,d.call(c.conditions,b)>=0},c.addCondition=function(b){var f;return e.debug("Add entity "+b.id+" to conditions array"),f=b.id,d.call(c.conditions,f)>=0?c.conditions.splice(c.conditions.indexOf(b.id),1):c.conditions.push(b.id),a.load("posts",c.conditions)},c.$on("postsLoaded",function(a,d){return e.debug("Referencing posts for entity "+b.entity_id+" ..."),e.debug(d),c.posts=d}),c.$on("facetsLoaded",function(a,d){return e.debug("Referencing facets for entity "+b.entity_id+" ..."),e.debug(d),c.facets=d})}]).service("DataRetrieverService",["configuration","$log","$http","$rootScope",function(a,b,c,d){var e;return e={},e.load=function(e,f){var g;return null==f&&(f=[]),g=""+a.ajax_url+"?action="+a.action+"&entity_id="+a.entity_id+"&type="+e,b.debug("Going to search "+e+" with conditions"),b.debug(f),c({method:"post",url:g,data:f}).success(function(a){return d.$broadcast(""+e+"Loaded",a)}).error(function(a,c){return b.warn("Error loading "+e+", statut "+c)})},e}]).config(function(a){return a.setConfiguration(window.wl_faceted_search_params)}),a(b=a('<div ng-controller="FacetedSearchWidgetController">\n      <div class="facets">\n        <h3>Facets</h3>\n        <ul>\n          <li ng-repeat="entity in facets" ng-click="addCondition(entity)" ng-class=" { \'selected\' : isInConditions(entity) }">\n            {{entity.label}} <small>({{entity.mainType}})</small>\n          </li>\n        </ul>\n      </div>\n      <div class="posts">\n        <div class="post" ng-repeat="post in posts">{{post.post_title}}</div>   \n      \n    <div class="conditions">\n      <h5>Filtri</h5>\n      <ul>\n        <li ng-repeat="condition in conditions"><small>{{condition}}</small></li>\n      </ul>\n    </div>\n      </div>\n      <br class="clear" />\n    </div>').appendTo("#wordlift-faceted-entity-search-widget"),c=angular.bootstrap(a("#wordlift-faceted-entity-search-widget"),["wordlift.facetedsearch.widget"])),c.invoke(["DataRetrieverService","$rootScope","$log",function(a,b){return b.$apply(function(){return a.load("posts"),a.load("facets")})}])}).call(this);
//# sourceMappingURL=wordlift-faceted-entity-search-widget.min.map